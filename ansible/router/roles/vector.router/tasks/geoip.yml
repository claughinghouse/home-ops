---

- name: Install the community repository
  ansible.builtin.get_url:
    url: https://www.routerperformance.net/mimugmail.conf
    dest: /usr/local/etc/pkg/repos/mimugmail.conf
    mode: 0644

- name: Install geoipupdate
  community.general.pkgng:
    name:
      - net/geoipupdate
    state: present

- block:
    - name: Create GeoIP Update config
      ansible.builtin.template:
        src: geoip/GeoIP.conf.j2
        dest: /usr/local/etc/geoip/GeoIP.conf
        mode: 0755
    - name: Create GeoIP Update cron job
      ansible.builtin.template:
        src: geoip/geoip.cron.j2
        dest: /usr/local/etc/cron.d/geoip.cron
        mode: 0644
  notify: Download geoip
