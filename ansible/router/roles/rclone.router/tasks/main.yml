---
- name: Create Rclone directories
  ansible.builtin.file:
    path: "{{ item }}"
    state: directory
    mode: 0755
  loop:
    - /usr/local/etc/rclone

- name: Install the community repository
  ansible.builtin.get_url:
    url: https://www.routerperformance.net/mimugmail.conf
    dest: /usr/local/etc/pkg/repos/mimugmail.conf
    mode: 0644

- name: Install rclone
  community.general.pkgng:
    name:
      - net/rclone
    state: present

- name: Create Rclone config
  ansible.builtin.template:
    src: rclone.conf.j2
    dest: /usr/local/etc/rclone/rclone.conf
    mode: 0755

- name: Create Rclone cron job
  ansible.builtin.template:
    src: rclone.cron.j2
    dest: /usr/local/etc/cron.d/rclone.cron
    mode: 0644
